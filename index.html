# Actualizar el código con los requisitos específicos

html_content = '''<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de Estadística - Modo Competencia</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <!-- QR Code Generator -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            color: #2c3e50;
            text-align: center;
        }
        .login-container, .admin-panel, .team-selection, .game-container, .results-container {
            display: none;
        }
        .active {
            display: block;
        }
        .question {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #eaf2f8;
            border-radius: 5px;
        }
        .options {
            margin-top: 10px;
        }
        .option {
            margin: 5px 0;
            padding: 10px;
            background-color: #d4e6f1;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .option:hover {
            background-color: #a9cce3;
        }
        .selected {
            background-color: #3498db;
            color: white;
        }
        .correct {
            background-color: #2ecc71;
            color: white;
        }
        .incorrect {
            background-color: #e74c3c;
            color: white;
        }
        .feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        .buttons {
            margin-top: 20px;
            text-align: center;
        }
        button {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 5px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        .result {
            margin-top: 20px;
            text-align: center;
            font-weight: bold;
            font-size: 1.2em;
        }
        .progress {
            margin-top: 20px;
            height: 20px;
            background-color: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background-color: #3498db;
            width: 0%;
            transition: width 0.5s;
        }
        .explanation {
            margin-top: 10px;
            padding: 10px;
            background-color: #f9e79f;
            border-radius: 5px;
            display: none;
        }
        .image-container {
            text-align: center;
            margin: 15px 0;
        }
        .image-container img {
            max-width: 100%;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .team-card {
            background-color: #fff;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .team-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .team-card.selected-team {
            border: 3px solid #3498db;
        }
        .team-name {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .team-score {
            font-size: 1.2em;
            color: #2c3e50;
        }
        .admin-controls {
            margin-top: 20px;
            padding: 15px;
            background-color: #eaf2f8;
            border-radius: 5px;
        }
        .team-progress {
            margin-top: 10px;
            padding: 10px;
            background-color: #f5f5f5;
            border-radius: 5px;
        }
        .qr-container {
            text-align: center;
            margin: 20px 0;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .tab-container {
            margin-top: 20px;
        }
        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ddd;
        }
        .tab-button {
            padding: 10px 20px;
            background-color: #f5f5f5;
            border: none;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
        }
        .tab-button.active {
            background-color: #3498db;
            color: white;
        }
        .tab-content {
            padding: 20px;
            background-color: #fff;
            border-radius: 0 0 5px 5px;
        }
        .tab-panel {
            display: none;
        }
        .tab-panel.active {
            display: block;
        }
        .leaderboard {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .leaderboard th, .leaderboard td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .leaderboard th {
            background-color: #3498db;
            color: white;
        }
        .leaderboard tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .leaderboard tr:hover {
            background-color: #e5e5e5;
        }
        .results-container {
            text-align: center;
            padding: 20px;
        }
        .results-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        .team-results {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }
        .team-result-card {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .team-position {
            font-size: 24px;
            font-weight: bold;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #3498db;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .team-position.first {
            background-color: gold;
            color: #333;
        }
        .team-position.second {
            background-color: silver;
            color: #333;
        }
        .team-position.third {
            background-color: #cd7f32;
            color: white;
        }
        .team-result-name {
            font-weight: bold;
            font-size: 18px;
        }
        .team-result-score {
            font-size: 20px;
            font-weight: bold;
            color: #2c3e50;
        }
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            animation: confetti-fall 5s ease-in-out infinite;
            z-index: 1000;
        }
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        .qr-code-display {
            text-align: center;
            margin: 20px 0;
        }
        .qr-code-display img {
            max-width: 250px;
            margin: 0 auto;
        }
        .team-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
        }
        .team-average {
            font-weight: bold;
            color: #2980b9;
        }
        .print-qr {
            margin-top: 10px;
        }
        @media print {
            body * {
                visibility: hidden;
            }
            .qr-container, .qr-container * {
                visibility: visible;
            }
            .qr-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Juego de Estadística para Veterinaria y Zootecnia</h1>
        
        <!-- Pantalla de inicio de sesión -->
        <div id="login-container" class="login-container active">
            <h2>Iniciar Sesión</h2>
            <div class="input-group">
                <label for="user-type">Seleccione su rol:</label>
                <select id="user-type">
                    <option value="admin">Administrador</option>
                    <option value="student">Estudiante</option>
                </select>
            </div>
            <div id="admin-login-fields">
                <div class="input-group">
                    <label for="admin-password">Contraseña de administrador:</label>
                    <input type="password" id="admin-password" placeholder="Ingrese la contraseña">
                </div>
            </div>
            <div id="student-login-fields" style="display: none;">
                <p>Escanea el código QR proporcionado por tu profesor o ingresa el código de la sesión:</p>
                <div class="input-group">
                    <label for="session-code">Código de sesión:</label>
                    <input type="text" id="session-code" placeholder="Ingresa el código de 6 dígitos">
                </div>
            </div>
            <div class="buttons">
                <button id="login-btn">Ingresar</button>
            </div>
        </div>
        
        <!-- Panel de administrador -->
        <div id="admin-panel" class="admin-panel">
            <h2>Panel de Administrador</h2>
            
            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="session-tab">Sesión</button>
                    <button class="tab-button" data-tab="teams-tab">Equipos</button>
                    <button class="tab-button" data-tab="progress-tab">Progreso</button>
                    <button class="tab-button" data-tab="results-tab">Resultados</button>
                </div>
                
                <div class="tab-content">
                    <!-- Pestaña de Sesión -->
                    <div id="session-tab" class="tab-panel active">
                        <h3>Información de la Sesión</h3>
                        <div class="session-info">
                            <p>Código de sesión: <span id="session-id">Generando...</span></p>
                            <div class="qr-container">
                                <h4>Código QR para acceso de estudiantes</h4>
                                <div id="qrcode"></div>
                                <p>Los estudiantes pueden escanear este código QR o ingresar el código de sesión manualmente.</p>
                                <button id="print-qr-btn" class="print-qr">Imprimir Código QR</button>
                            </div>
                            <div class="admin-controls">
                                <h4>Controles de Sesión</h4>
                                <button id="start-session-btn">Iniciar Sesión</button>
                                <button id="pause-session-btn">Pausar Sesión</button>
                                <button id="end-session-btn">Finalizar Sesión</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pestaña de Equipos -->
                    <div id="teams-tab" class="tab-panel">
                        <h3>Equipos Participantes</h3>
                        <div id="teams-list" class="team-grid">
                            <!-- Los equipos se cargarán dinámicamente aquí -->
                        </div>
                    </div>
                    
                    <!-- Pestaña de Progreso -->
                    <div id="progress-tab" class="tab-panel">
                        <h3>Progreso de los Equipos</h3>
                        <div id="teams-progress">
                            <!-- El progreso de los equipos se cargará dinámicamente aquí -->
                        </div>
                    </div>
                    
                    <!-- Pestaña de Resultados -->
                    <div id="results-tab" class="tab-panel">
                        <h3>Tabla de Clasificación</h3>
                        <table class="leaderboard">
                            <thead>
                                <tr>
                                    <th>Posición</th>
                                    <th>Equipo</th>
                                    <th>Integrantes</th>
                                    <th>Preguntas</th>
                                    <th>Correctas</th>
                                    <th>Promedio</th>
                                    <th>Puntuación</th>
                                </tr>
                            </thead>
                            <tbody id="leaderboard-body">
                                <!-- Los resultados se cargarán dinámicamente aquí -->
                            </tbody>
                        </table>
                        <div class="buttons" style="margin-top: 30px;">
                            <button id="show-final-results-btn">Mostrar Resultados Finales</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Selección de equipo para estudiantes -->
        <div id="team-selection" class="team-selection">
            <h2>Selecciona tu Equipo</h2>
            <div id="student-teams-grid" class="team-grid">
                <!-- Los equipos se cargarán dinámicamente aquí -->
            </div>
            <div class="buttons">
                <button id="join-team-btn" disabled>Unirse al Equipo</button>
            </div>
        </div>
        
        <!-- Contenedor del juego -->
        <div id="game-container" class="game-container">
            <div class="team-info">
                <h3>Equipo: <span id="current-team-name">-</span></h3>
                <div class="progress">
                    <div class="progress-bar" id="progress"></div>
                </div>
            </div>
            
            <div id="question-container" class="question">
                <h3 id="question-text">Pregunta aparecerá aquí</h3>
                <div class="image-container" id="question-image-container">
                    <!-- La imagen se insertará aquí si es necesario -->
                </div>
                <div class="options" id="options-container">
                    <!-- Las opciones se insertarán aquí -->
                </div>
                <div class="feedback" id="feedback"></div>
                <div class="explanation" id="explanation"></div>
            </div>
            
            <div class="buttons">
                <button id="check-btn">Comprobar</button>
                <button id="next-btn" disabled>Siguiente</button>
            </div>
            
            <div class="result" id="result"></div>
        </div>
        
        <!-- Pantalla de resultados finales -->
        <div id="results-container" class="results-container">
            <h2 class="results-title">¡Juego Finalizado!</h2>
            <div id="final-results" class="team-results">
                <!-- Los resultados finales se cargarán dinámicamente aquí -->
            </div>
            <div class="buttons">
                <button id="new-game-btn">Nuevo Juego</button>
            </div>
        </div>
    </div>

    <script>
        // Configuración de Firebase (reemplazar con tus propias credenciales)
        const firebaseConfig = {
            apiKey: "AIzaSyDEMOKEY",
            authDomain: "estadistica-juego.firebaseapp.com",
            databaseURL: "https://estadistica-juego-default-rtdb.firebaseio.com",
            projectId: "estadistica-juego",
            storageBucket: "estadistica-juego.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };
        
        // Inicializar Firebase (comentado para evitar errores, ya que no tenemos credenciales reales)
        // firebase.initializeApp(firebaseConfig);
        
        // Contraseña de administrador
        const ADMIN_PASSWORD = "admin123";
        
        // Simulación de base de datos para el prototipo
        const simulatedDB = {
            sessions: {
                "ABC123": {
                    active: true,
                    startTime: Date.now(),
                    teams: {}
                }
            },
            teams: {
                "team1": { name: "Equipo A", score: 0, questionsAnswered: 0, correctAnswers: 0, members: 0 },
                "team2": { name: "Equipo B", score: 0, questionsAnswered: 0, correctAnswers: 0, members: 0 },
                "team3": { name: "Equipo C", score: 0, questionsAnswered: 0, correctAnswers: 0, members: 0 },
                "team4": { name: "Equipo D", score: 0, questionsAnswered: 0, correctAnswers: 0, members: 0 },
                "team5": { name: "Equipo E", score: 0, questionsAnswered: 0, correctAnswers: 0, members: 0 }
            }
        };
        
        // Variables globales
        let sessionCode = generateSessionCode();
        let allTeamsFinished = false;
        let gameActive = false;
        
        // Generar un código de sesión aleatorio
        function generateSessionCode() {
            const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
            let code = "";
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }
        
        // Generar código QR
        function generateQRCode(text) {
            const qr = qrcode(0, 'M');
            qr.addData(text);
            qr.make();
            return qr.createImgTag(5);
        }
        
        // Preguntas del juego
        const questions = [
            {
                question: "¿Qué representa el valor p en un estudio sobre la eficacia de un nuevo antibiótico para tratar mastitis en vacas?",
                options: [
                    "La probabilidad de que el antibiótico sea efectivo",
                    "La probabilidad de obtener los resultados observados (o más extremos) si el antibiótico no tiene efecto",
                    "El porcentaje de vacas que se curaron con el antibiótico",
                    "El nivel de significancia establecido por el investigador"
                ],
                correctIndex: 1,
                explanation: "El valor p representa la probabilidad de obtener los resultados observados (o más extremos) si la hipótesis nula fuera cierta. En este caso, si el antibiótico realmente no tuviera efecto. Un valor p pequeño sugiere que es poco probable que los resultados se deban al azar.",
                image: "https://cdn.abacus.ai/images/7738cc8a-108f-44e1-a8a0-81ec96bd8772.png"
            },
            {
                question: "En un estudio sobre el efecto de un suplemento alimenticio en el peso de terneros, se obtuvo un valor p de 0.03. ¿Qué significa esto?",
                options: [
                    "El suplemento aumenta el peso en un 3%",
                    "Hay un 3% de probabilidad de que el suplemento sea efectivo",
                    "Hay un 3% de probabilidad de obtener estos resultados (o más extremos) si el suplemento no tiene efecto",
                    "El 3% de los terneros respondieron al suplemento"
                ],
                correctIndex: 2,
                explanation: "Un valor p de 0.03 significa que hay un 3% de probabilidad de obtener estos resultados (o más extremos) si la hipótesis nula fuera cierta (si el suplemento no tuviera efecto). Como es menor que el nivel de significancia típico de 0.05, generalmente se consideraría estadísticamente significativo.",
                image: null
            },
            {
                question: "¿Qué es el valor crítico en una prueba de hipótesis sobre la eficacia de una vacuna en cerdos?",
                options: [
                    "El número mínimo de cerdos que deben ser vacunados",
                    "El valor que determina el límite entre rechazar o no rechazar la hipótesis nula",
                    "El porcentaje mínimo de eficacia que debe tener la vacuna",
                    "La dosis mínima efectiva de la vacuna"
                ],
                correctIndex: 1,
                explanation: "El valor crítico es el punto de corte en la distribución de probabilidad que separa la región de rechazo de la región de no rechazo de la hipótesis nula. Si el estadístico de prueba es más extremo que el valor crítico, rechazamos la hipótesis nula.",
                image: "https://cdn.abacus.ai/images/c2d4ed73-1b0c-4fc9-8878-b9941b16bf3b.png"
            },
            {
                question: "En un estudio sobre dos métodos de inseminación artificial en bovinos, ¿qué significa un valor p = 0.08?",
                options: [
                    "Hay una diferencia significativa entre los dos métodos",
                    "No hay una diferencia significativa entre los dos métodos (asumiendo α = 0.05)",
                    "El método nuevo es 8% mejor que el método tradicional",
                    "Hay un 8% de probabilidad de que ambos métodos sean iguales"
                ],
                correctIndex: 1,
                explanation: "Un valor p de 0.08 es mayor que el nivel de significancia típico de 0.05, lo que significa que no rechazamos la hipótesis nula. Por lo tanto, no hay evidencia suficiente para afirmar que existe una diferencia significativa entre los dos métodos de inseminación.",
                image: null
            },
            {
                question: "¿Cuál de las siguientes afirmaciones sobre el valor p es INCORRECTA?",
                options: [
                    "Un valor p pequeño indica evidencia contra la hipótesis nula",
                    "El valor p es la probabilidad de que la hipótesis nula sea verdadera",
                    "El valor p se compara con el nivel de significancia (α) para tomar decisiones",
                    "Un valor p = 0.01 proporciona mayor evidencia contra la hipótesis nula que un valor p = 0.05"
                ],
                correctIndex: 1,
                explanation: "La afirmación incorrecta es que 'El valor p es la probabilidad de que la hipótesis nula sea verdadera'. El valor p NO indica la probabilidad de que la hipótesis nula sea verdadera o falsa. Es la probabilidad de obtener los resultados observados (o más extremos) si la hipótesis nula fuera cierta.",
                image: null
            },
            {
                question: "En un experimento sobre el efecto de un nuevo alimento en el peso de pollos, se obtuvo el siguiente resultado. ¿Qué conclusión es correcta?",
                options: [
                    "No hay diferencia significativa entre los dos alimentos",
                    "El nuevo alimento produce un aumento significativo en el peso de los pollos",
                    "El alimento tradicional es mejor que el nuevo",
                    "No se puede determinar sin conocer el valor p"
                ],
                correctIndex: 1,
                explanation: "La imagen muestra una diferencia estadísticamente significativa (indicada por el asterisco) entre el grupo control y el grupo con el nuevo alimento. El nuevo alimento produce un aumento significativo en el peso de los pollos.",
                image: "https://cdn.abacus.ai/images/4f3a871a-7027-422d-bcf4-e0d9a1349caf.png"
            },
            {
                question: "Si en un estudio sobre la eficacia de una vacuna contra la fiebre aftosa en bovinos se establece α = 0.01, ¿qué significa esto?",
                options: [
                    "La vacuna debe tener al menos 1% de eficacia",
                    "Se acepta un 1% de probabilidad de concluir incorrectamente que la vacuna es efectiva cuando no lo es",
                    "La vacuna debe funcionar en al menos el 99% de los animales",
                    "El 1% de los animales no responderá a la vacuna"
                ],
                correctIndex: 1,
                explanation: "El nivel de significancia (α) representa la probabilidad máxima que estamos dispuestos a aceptar de cometer un error Tipo I, es decir, rechazar incorrectamente la hipótesis nula cuando es verdadera. En este caso, estamos dispuestos a aceptar un 1% de probabilidad de concluir que la vacuna es efectiva cuando en realidad no lo es.",
                image: null
            },
            {
                question: "Observa la siguiente gráfica sobre el efecto de una vacuna en bovinos. ¿Qué conclusión es correcta?",
                options: [
                    "La vacuna no tiene efecto significativo",
                    "La vacuna reduce significativamente la enfermedad",
                    "La vacuna aumenta la enfermedad",
                    "No se puede determinar el efecto sin más información"
                ],
                correctIndex: 1,
                explanation: "La gráfica muestra una diferencia estadísticamente significativa (p < 0.001, indicado por *
